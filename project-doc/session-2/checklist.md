# Чек-лист: Session 2 — Admin Panel for Bookings

**Источник:** KG001 (PRD-booking-system.md)
**Дата:** 2026-02-10

---

## Обзор

Session 2 — админ-панель для управления бронированиями. Админ — ключевая роль в системе. Он управляет расписанием, создаёт брони по телефону, подтверждает/отменяет записи, блокирует слоты, настраивает параметры. Админка должна работать на мобильном и десктопе (responsive). Хронометраж: текущий заезд, обратный отсчёт, Timeline View. Несколько админов с логированием действий.

---

## Проверка кода (Developer)

- [ ] **T-001** `npm run build` — backend без ошибок
- [ ] **T-002** `npm run build` — frontend без ошибок
- [ ] **T-003** `npx tsc --noEmit` — типы корректны
- [ ] **T-004** Нет отладочного кода
- [ ] **T-005** Все admin API endpoints защищены JWT авторизацией
- [ ] **T-006** Новые маршруты админки не ломают существующие

---

## Проверка в браузере — Dashboard / Timeline View

> **Суть:** Главный экран админки бронирований. Визуальная шкала заездов на день,
> статистика, хронометраж. Админ видит текущую ситуацию одним взглядом.
> Должен работать на мобильном (админ на площадке с телефоном) и на десктопе.

### Desktop

- [ ] **D-001** Timeline отображает все слоты выбранного дня | CRITICAL
- [ ] **D-002** Текущий заезд выделен цветом + индикатор текущего времени (красная линия) | HIGH
- [ ] **D-003** Хронометраж: текст "Идёт заезд N, осталось X мин" | HIGH
- [ ] **D-004** Хронометраж: "Следующий заезд через X мин" | HIGH
- [ ] **D-005** Обратный отсчёт обновляется в реальном времени (без перезагрузки) | HIGH
- [ ] **D-006** Статистика: кол-во бронирований / участников / выручка / загрузка % | HIGH
- [ ] **D-007** Выбор даты на dashboard — обновление Timeline и статистики | HIGH
- [ ] **D-008** Слоты в Timeline кликабельны — открывают детали слота | MEDIUM

### Mobile (responsive)

- [ ] **D-020** Dashboard открывается и читаем на мобильном (375px) | CRITICAL
- [ ] **D-021** Timeline адаптируется под узкий экран (вертикальный список или горизонтальный скролл) | HIGH
- [ ] **D-022** Статистика компактная, но читаемая | MEDIUM
- [ ] **D-023** Touch targets >= 44px на все интерактивные элементы | HIGH

---

## Проверка — Таблица бронирований

> **Суть:** Список всех бронирований с фильтрами. Админ ищет нужную бронь,
> видит статус, может подтвердить/отменить. Иконка источника показывает
> откуда пришла бронь (TWA / виджет / ручная).

- [ ] **B-001** Таблица отображает бронирования с колонками: ID, время, клиент, тип, участники, сумма, статус, источник, действия | CRITICAL
- [ ] **B-002** Фильтр по дате работает | HIGH
- [ ] **B-003** Фильтр по статусу (pending/confirmed/cancelled/completed/no_show) | HIGH
- [ ] **B-004** Фильтр по типу (взрослые/дети) | MEDIUM
- [ ] **B-005** Поиск по имени/телефону | HIGH
- [ ] **B-006** Иконка источника: TWA (Telegram) / виджет (глобус) / ручная (телефон) | HIGH
- [ ] **B-007** Действие "Подтвердить" -> статус pending -> confirmed | CRITICAL
- [ ] **B-008** Действие "Отменить" -> ввод причины -> статус -> cancelled | HIGH
- [ ] **B-009** Действие "Редактировать" -> изменение деталей брони | MEDIUM
- [ ] **B-010** На мобильном таблица адаптирована (карточки или горизонтальный скролл) | HIGH

---

## Проверка — Ручное создание бронирования

> **Суть:** Админ принимает звонок от клиента и создаёт бронь вручную.
> Должно быть быстро и просто — клиент на линии ждёт.

- [ ] **M-001** Кнопка "Создать бронь" доступна | HIGH
- [ ] **M-002** Форма: выбор даты, слота, длительности | CRITICAL
- [ ] **M-003** Форма: имя + телефон (обязательно) | CRITICAL
- [ ] **M-004** Бронь создаётся с source = 'admin' | HIGH
- [ ] **M-005** Логируется какой админ создал | HIGH
- [ ] **M-006** После создания — слот обновляет свободные места | CRITICAL
- [ ] **M-007** На мобильном форма создания удобна (сценарий: админ на площадке с телефоном) | HIGH

---

## Проверка — Управление слотами

> **Суть:** Сетка слотов на день. Админ может заблокировать отдельный слот
> (техническая неисправность) или целый день (праздник, мероприятие).

- [ ] **SL-001** Сетка слотов на выбранный день отображается | HIGH
- [ ] **SL-002** Блокировка отдельного слота (с указанием причины) | HIGH
- [ ] **SL-003** Разблокировка слота | HIGH
- [ ] **SL-004** Заблокированный слот недоступен для бронирования (проверить во фронте) | CRITICAL
- [ ] **SL-005** Блокировка целого дня (schedule override) | HIGH
- [ ] **SL-006** Исключение для дня: другие рабочие часы (для праздников) | MEDIUM

---

## Проверка — Настройки бронирования

> **Суть:** Конфигурация системы. Рабочие часы, цены, автопилот.
> Изменения должны сразу влиять на генерацию слотов и виджет.

- [ ] **C-001** Рабочие часы по дням недели | HIGH
- [ ] **C-002** Интервал слотов, буфер между заездами | HIGH
- [ ] **C-003** Длительности заездов + цены (взрослые / дети) | HIGH
- [ ] **C-004** Максимум участников в заезде (по умолчанию 8) | MEDIUM
- [ ] **C-005** Toggle "Автопилот" (автоподтверждение) | HIGH
- [ ] **C-006** Горизонт бронирования (90 дней по умолчанию) | MEDIUM
- [ ] **C-007** После сохранения настроек — виджет отражает изменения | CRITICAL

---

## Проверка API (Admin endpoints)

- [ ] **AA-001** GET /api/admin/booking/dashboard — данные для дашборда | HIGH
- [ ] **AA-002** GET /api/admin/booking/bookings — список с фильтрами | HIGH
- [ ] **AA-003** POST /api/admin/booking/bookings — ручное создание | HIGH
- [ ] **AA-004** PATCH /api/admin/booking/bookings/:id — обновление статуса | HIGH
- [ ] **AA-005** GET /api/admin/booking/slots?date= — слоты на дату | HIGH
- [ ] **AA-006** POST /api/admin/booking/slots/:id/block — блокировка | HIGH
- [ ] **AA-007** POST /api/admin/booking/slots/:id/unblock — разблокировка | HIGH
- [ ] **AA-008** POST /api/admin/booking/schedule/override — исключение для дня | HIGH
- [ ] **AA-009** GET /api/admin/booking/config — чтение настроек | HIGH
- [ ] **AA-010** PATCH /api/admin/booking/config — обновление настроек | HIGH
- [ ] **AA-011** Все endpoints возвращают 401 без JWT | CRITICAL

---

## Edge Cases

- [ ] **E-001** Пустой день (нет бронирований) — dashboard показывает пустое состояние | MEDIUM
- [ ] **E-002** Админ пытается подтвердить уже подтверждённую бронь — понятное сообщение | MEDIUM
- [ ] **E-003** Админ пытается создать бронь на заблокированный слот — ошибка | HIGH
- [ ] **E-004** Два админа одновременно подтверждают одну бронь — нет дублирования | HIGH
- [ ] **E-005** Очень длинное имя клиента — не ломает таблицу | LOW

---

## Статистика

- Проверка кода: 6
- Dashboard/Timeline: 12
- Таблица бронирований: 10
- Ручное создание: 7
- Управление слотами: 6
- Настройки: 7
- API: 11
- Edge cases: 5
- **Всего: 64 проверки**
