# Branch Protection & Git Workflow

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –≤–µ—Ç–æ–∫

```
main (production) ‚Üê –∑–∞—â–∏—â–µ–Ω–∞
  ‚Üë
  ‚îî‚îÄ‚îÄ dev (development) ‚Üê —Ä–∞–±–æ—á–∞—è –≤–µ—Ç–∫–∞
       ‚Üë
       ‚îî‚îÄ‚îÄ feature/* ‚Üê —Ñ–∏—á–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
```

## –ü—Ä–∞–≤–∏–ª–∞ —Ä–∞–±–æ—Ç—ã

### ‚úÖ –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ (dev)
- –í—Å–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –≤–µ–¥–µ—Ç—Å—è –≤ –≤–µ—Ç–∫–µ `dev`
- Claude Code –º–æ–∂–µ—Ç –∫–æ–º–º–∏—Ç–∏—Ç—å –Ω–∞–ø—Ä—è–º—É—é –≤ `dev`
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ dev-—Å–µ—Ä–≤–µ—Ä–µ: `dev.yourdomain.com`

### üîí Production (main)
- **–ó–∞–ø—Ä–µ—â–µ–Ω—ã –ø—Ä—è–º—ã–µ –ø—É—à–∏**
- –¢–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ Pull Request –∏–∑ `dev`
- –î–µ–ø–ª–æ–π –Ω–∞ production: `yourdomain.com`
- –°–ª–∏—è–Ω–∏–µ —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ dev-—Å–µ—Ä–≤–µ—Ä–µ

## Workflow

### 1. –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –Ω–æ–≤–æ–π —Ñ–∏—á–∏
```bash
# Claude —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ dev –≤–µ—Ç–∫–µ
git checkout dev
git pull origin dev

# –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞...
git add .
git commit -m "feat: –æ–ø–∏—Å–∞–Ω–∏–µ —Ñ–∏—á–∏"
git push origin dev
```

### 2. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ dev-—Å–µ—Ä–≤–µ—Ä–µ
- –î–µ–ø–ª–æ–π –Ω–∞ dev-—Å–µ—Ä–≤–µ—Ä (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–ª–∏ –≤—Ä—É—á–Ω—É—é)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∞–≥–æ–≤ (–∫–æ–º–º–∏—Ç –≤ dev)

### 3. –†–µ–ª–∏–∑ –≤ production
```bash
# –ö–æ–≥–¥–∞ –≤—Å—ë –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ –Ω–∞ dev
git checkout main
git pull origin main
git merge dev
git push origin main
```

–ò–ª–∏ —á–µ—Ä–µ–∑ Pull Request –Ω–∞ GitHub (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):
1. –û—Ç–∫—Ä—ã—Ç—å PR: `dev` ‚Üí `main`
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
3. Merge PR
4. –î–µ–ø–ª–æ–π –Ω–∞ production —Å–µ—Ä–≤–µ—Ä

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Branch Protection –Ω–∞ GitHub

### –®–∞–≥ 1: –û—Ç–∫—Ä—ã—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
1. –ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ https://github.com/simvol2030/loyalty-system-universal
2. –ù–∞–∂–∞—Ç—å **Settings** (–≤–∫–ª–∞–¥–∫–∞ —Å–ø—Ä–∞–≤–∞)
3. –í –ª–µ–≤–æ–º –º–µ–Ω—é –≤—ã–±—Ä–∞—Ç—å **Branches**

### –®–∞–≥ 2: –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–∞–≤–∏–ª–æ –¥–ª—è main
1. –ù–∞–∂–∞—Ç—å **Add branch protection rule**
2. –í –ø–æ–ª–µ **Branch name pattern** –≤–≤–µ—Å—Ç–∏: `main`

### –®–∞–≥ 3: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø—Ä–∞–≤–∏–ª–∞ –∑–∞—â–∏—Ç—ã
–û—Ç–º–µ—Ç–∏—Ç—å –≥–∞–ª–æ—á–∫–∏:

- ‚úÖ **Require a pull request before merging**
  - ‚úÖ **Require approvals** (–º–∏–Ω–∏–º—É–º 0, –µ—Å–ª–∏ —Ä–∞–±–æ—Ç–∞–µ—à—å –æ–¥–∏–Ω)

- ‚úÖ **Do not allow bypassing the above settings**

- ‚ö†Ô∏è **–ù–ï –æ—Ç–º–µ—á–∞—Ç—å** "Allow force pushes" - —ç—Ç–æ –æ–ø–∞—Å–Ω–æ –¥–ª—è main

### –®–∞–≥ 4: –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
–ù–∞–∂–∞—Ç—å **Create** –≤–Ω–∏–∑—É —Å—Ç—Ä–∞–Ω–∏—Ü—ã

## –†–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:
- ‚ùå –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –ø—É—à–∏—Ç—å –Ω–∞–ø—Ä—è–º—É—é –≤ `main`
- ‚úÖ –ú–æ–∂–Ω–æ –ø—É—à–∏—Ç—å –≤ `dev` —Å–≤–æ–±–æ–¥–Ω–æ
- ‚úÖ –°–ª–∏—è–Ω–∏–µ `dev ‚Üí main` —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ Pull Request
- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å production –∫–æ–¥–∞

## –ö–æ–º–∞–Ω–¥—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã

### –ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è —Ä–∞–±–æ—Ç–∞ (Claude –∏–ª–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫)
```bash
git checkout dev
git pull origin dev
# —Ä–∞–±–æ—Ç–∞...
git add .
git commit -m "commit message"
git push origin dev
```

### –†–µ–ª–∏–∑ –≤ production (–ø–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ dev)
**–í–∞—Ä–∏–∞–Ω—Ç 1: –ß–µ—Ä–µ–∑ GitHub UI**
1. –û—Ç–∫—Ä—ã—Ç—å https://github.com/simvol2030/loyalty-system-universal/pulls
2. –°–æ–∑–¥–∞—Ç—å New Pull Request: `dev ‚Üí main`
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
4. Merge Pull Request

**–í–∞—Ä–∏–∞–Ω—Ç 2: –ß–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥–Ω—É—é —Å—Ç—Ä–æ–∫—É**
```bash
# –ù–ï –ë–£–î–ï–¢ –†–ê–ë–û–¢–ê–¢–¨ –ø–æ—Å–ª–µ –∑–∞—â–∏—Ç—ã main:
git checkout main
git merge dev
git push  # ‚Üê –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ!

# –ù—É–∂–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å PR —á–µ—Ä–µ–∑ GitHub
```

## –î–µ–ø–ª–æ–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä–∞

### Dev Server (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –ø—É—à–µ –≤ dev)
```bash
# –ü–æ—Å–ª–µ git push origin dev
# ‚Üí –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π –Ω–∞ dev.yourdomain.com
```

### Production Server (–ø–æ—Å–ª–µ merge –≤ main)
```bash
# –ü–æ—Å–ª–µ merge PR: dev ‚Üí main
# ‚Üí –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π –Ω–∞ yourdomain.com
```

## –≠–∫—Å—Ç—Ä–µ–Ω–Ω—ã–µ —Å–ª—É—á–∞–∏

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ —ç–∫—Å—Ç—Ä–µ–Ω–Ω–æ –∑–∞–ø—É—à–∏—Ç—å –≤ main (–ö–†–ê–ô–ù–ò–ô –°–õ–£–ß–ê–ô):
1. –í—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç—å branch protection –≤ Settings ‚Üí Branches
2. –°–¥–µ–ª–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
3. –í–∫–ª—é—á–∏—Ç—å protection –æ–±—Ä–∞—Ç–Ω–æ

**–ù–æ –ª—É—á—à–µ –í–°–ï–ì–î–ê —á–µ—Ä–µ–∑ dev ‚Üí main PR!**
